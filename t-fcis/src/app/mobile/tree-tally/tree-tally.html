
<div class="tally-container">
  <h2>Tree Tally for Plot {{ plot?.plotNumber }}</h2>

  <!-- Add New Tree Button -->
  <div class="add-tree-actions" *ngIf="!isAdding">
    <button mat-raised-button color="primary" (click)="startAdding()">Add New Tree</button>
  </div>

  <!-- New Tree Form Card -->
  <mat-card *ngIf="isAdding" class="add-tree-card">
    <mat-card-header>
      <mat-card-title>Add New Tree</mat-card-title>
    </mat-card-header>
    <mat-card-content [formGroup]="newTreeForm">
      <mat-form-field appearance="fill">
        <mat-label>Species Code</mat-label>
        <input matInput formControlName="speciesCode" placeholder="e.g., CRYJA">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>DBH (cm)</mat-label>
        <input matInput type="number" formControlName="dbh" placeholder="e.g., 25.5">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Height (m)</mat-label>
        <input matInput type="number" formControlName="height" placeholder="e.g., 20.1">
      </mat-form-field>
    </mat-card-content>
    <mat-card-actions>
      <button mat-button color="primary" (click)="saveTree()" [disabled]="newTreeForm.invalid">Save</button>
      <button mat-button (click)="cancelAdding()">Cancel</button>
    </mat-card-actions>
  </mat-card>

  <!-- Tree List -->
  <mat-list>
    <div mat-subheader>Surveyed Trees</div>
    <mat-list-item *ngFor="let tree of trees">
      <div mat-line><strong>Tree #{{ tree.treeNumber }}</strong> - {{ tree.speciesCode }}</div>
      <div mat-line>DBH: {{ tree.dbh }} cm | Height: {{ tree.height || 'N/A' }} m</div>
    </mat-list-item>
  </mat-list>

</div>
